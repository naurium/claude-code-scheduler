#!/bin/bash

export PATH="/usr/local/bin:/usr/bin:/bin:$$PATH"
export HOME="${HOME_DIR}"

LOG_FILE="${LOG_DIR}/claude_scheduler.log"
mkdir -p "$$(dirname "$$LOG_FILE")"

echo "$$(date '+%Y-%m-%d %H:%M:%S') - Starting scheduled task" >> "$$LOG_FILE"

if command -v claude &> /dev/null; then
    ${COMMAND} >> "$$LOG_FILE" 2>&1
    echo "$$(date '+%Y-%m-%d %H:%M:%S') - Task completed" >> "$$LOG_FILE"
else
    echo "$$(date '+%Y-%m-%d %H:%M:%S') - ERROR: claude command not found" >> "$$LOG_FILE"
    echo "PATH=$$PATH" >> "$$LOG_FILE"
fi

echo "---" >> "$$LOG_FILE"