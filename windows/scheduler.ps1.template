$$logDir = "${LOG_DIR}"
$$logFile = Join-Path $$logDir "claude_scheduler.log"

if (!(Test-Path $$logDir)) {
    New-Item -ItemType Directory -Path $$logDir -Force | Out-Null
}

$$timestamp = Get-Date -Format "yyyy-MM-dd HH:mm:ss"
Add-Content -Path $$logFile -Value "$$timestamp - Starting scheduled task"

# Run claude through WSL
try {
    $$output = wsl ${COMMAND} 2>&1
    Add-Content -Path $$logFile -Value $$output
    Add-Content -Path $$logFile -Value "$$timestamp - Task completed"
} catch {
    Add-Content -Path $$logFile -Value "$$timestamp - ERROR: Failed to run claude through WSL"
    Add-Content -Path $$logFile -Value "$$timestamp - Make sure WSL is installed and claude is configured in WSL"
    Add-Content -Path $$logFile -Value "Error details: $$_"
}

Add-Content -Path $$logFile -Value "---"